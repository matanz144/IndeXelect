!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t=t||self).exportFromJSON=e()}(this,function(){"use strict";function j(t,e){if("[object Array]"!==Object.prototype.toString.call(t))throw new Error(e)}function w(e){return Object.keys(e).map(function(t){return e[t]})}function O(t){return Object.keys(t)}function t(e){return Object.keys(e).map(function(t){return[t,e[t]]})}function g(t,e){var n="."+e,r=new RegExp("(\\"+e+")?$");return t.replace(/\s+/,"_").replace(r,n)}function C(t,e,n){void 0===n&&(n="download");var r=function(t,e){switch(e){case"txt":return"data:text/plain;charset=utf-8,"+encodeURIComponent(t);case"json":return"data:application/json;charset=utf-8,"+encodeURIComponent(t);case"csv":return"data:text/csv;charset=utf-8,\ufeff"+encodeURIComponent(t);case"xls":return"data:application/vnd.ms-excel;charset=utf-8,"+encodeURIComponent(t);default:return""}}(t,e),o=document.createElement("a");o.href=r,o.download=n,o.setAttribute("style","visibility:hidden"),document.body.appendChild(o),o.click(),document.body.removeChild(o)}function I(c){return c.map(t).reduce(function(t,e,a){return e.reduce(function(t,e){var n=e[0],r=e[1],o=t[n]||Array.from({length:c.length}).map(function(t){return""});return o[a]=("string"!=typeof r?JSON.stringify(r):r)||"",t[n]=o,t},t)},Object.create(null))}function N(t){return'\n    <html>\n      <head>\n        <meta charset="UTF-8">\n      </head >\n      <body>\n        '+(e=I(t),n=O(e),r=w(e).map(function(t){return t.map(function(t){return"<td>"+t+"</td>"})}).reduce(function(t,n){return t.map(function(t,e){return""+t+n[e]})}),"\n    <table>\n      <thead><tr><th><b>"+n.join("</b></th><th><b>")+"</b></th></tr></thead>\n      <tbody><tr>"+r.join("</tr><tr>")+"</tr></tbody>\n    </table>\n  ")+"\n      </body>\n    </html >\n  ";var e,n,r}function e(t){var e,n=t.data,r=t.fileName,o=void 0===r?"download":r,a=t.exportType,c=void 0===a?"txt":a,u=t.replacer,i=void 0===u?null:u,d=t.space,s=void 0===d?4:d,f=t.processor,l=void 0===f?C:f,p=t.withBOM,v=void 0!==p&&p,h="Invalid export data. Please provide an array of object",m="Can't export unknown data type "+c+".",y=function(t){try{return"string"==typeof t?JSON.parse(t):t}catch(t){throw new Error("Invalid export data. Please provide a valid JSON")}}(n),b=function(t,e,n){void 0===e&&(e=null);try{return JSON.stringify(t,e,n)}catch(t){throw new Error("Invalid export data. Please provide valid JSON object")}}(y,i,s);switch(c){case"txt":return l(b,c,g(o,"txt"));case"json":return l(b,c,g(o,"json"));case"csv":j(y,h);var x=O(e=I(y)).join(",")+"\r\n"+w(e).map(function(t){return t.map(function(t){return'"'+t.replace(/\"/g,'""')+'"'})}).reduce(function(t,n){return t.map(function(t,e){return t+","+n[e]})}).join("\r\n");return l(v?"\ufeff"+x:x,c,g(o,"csv"));case"xls":return j(y,h),l(N(y),c,g(o,"xls"));default:throw new Error(m)}}var n;return(n=e||(e={})).types={txt:"txt",json:"json",csv:"csv",xls:"xls"},n.processors={downloadFile:C},e});
